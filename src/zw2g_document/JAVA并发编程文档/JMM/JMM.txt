happens-before规则和as-if-serial语义

1:happens-before
    核心原则:保证数据内存的可见性，一个操作的执行结果要对另一个结果可见

    四种实现该原则的规则
        1程序顺序规则(不理解)
        2监视器锁规则：对一个监视器的解锁，h-b于对一个监视器的加锁
        3volatile：对该变量的写hb于该变量的读

    方法手段
        四大内存屏障：执行前必须保证数据的内存可见性



2:as-if-serial
核心原则:保证程序的执行结果不能被改变，编译器不能对有数据依赖的操作做重排序



不同的线程的指令流水不会交叉，只会发生在自己的cpu流水集中
本质就是每个线程都有专属于自己的栈帧，在线程调用方法的时候会创建自己的栈帧，在栈帧中执行
class文件中的指令，所以不同线程的指令流水并不是放在一起同时执行的，而是由cpu分别对应线程
执行的